syntax = "proto3";

package reservation;

option java_multiple_files = true;
option java_package = "com.devoops.reservation.grpc.proto";

service ReservationInternalService {
  rpc CheckReservationsExist(CheckReservationsExistRequest) returns (CheckReservationsExistResponse);
  rpc CheckGuestCanBeDeleted(CheckGuestDeletionRequest) returns (CheckDeletionResponse);
  rpc CheckHostCanBeDeleted(CheckHostDeletionRequest) returns (CheckDeletionResponse);
  rpc CheckRatingEligibility(CheckRatingEligibilityRequest) returns (CheckRatingEligibilityResponse);
}

message CheckReservationsExistRequest {
  string accommodation_id = 1;
  string start_date = 2;
  string end_date = 3;
}

message CheckReservationsExistResponse {
  bool has_reservations = 1;
}

message CheckGuestDeletionRequest {
  string guest_id = 1;
}

message CheckHostDeletionRequest {
  string host_id = 1;
}

message CheckDeletionResponse {
  bool can_be_deleted = 1;
  string reason = 2;
  int32 active_reservation_count = 3;
}

message CheckRatingEligibilityRequest {
  string guest_id   = 1;
  string target_id  = 2;
  string target_type = 3;
}

message CheckRatingEligibilityResponse {
  bool eligible = 1;
  string reason  = 2;
}
